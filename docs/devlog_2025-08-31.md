# TRIWi App 開発日誌（2025-08-31）

## 現状のディレクトリ構成

```
triw-app/
├─ package.json                 # 起動/ビルド scripts
├─ tsconfig.json                # TypeScript 設定
├─ next.config.js                # Next.js 設定
├─ .gitignore                    # .env* を除外
├─ .env.local                    # Spotify Client ID 等（Git 管理対象外）
├─ README.md                     # プロジェクト概要
├─ docs/                         # 開発ドキュメント
│   └─ devlog_2025-08-31.md      # ← 本ファイル
└─ src/
   └─ app/
      ├─ page.tsx                # Home ✅ 表示
      ├─ login/
      │  └─ page.tsx             # Login with Spotify ボタン
      └─ api/
         └─ auth/
            ├─ login/
            │  └─ route.ts       # Spotify 認可へリダイレクト（PKCE 発行）
            ├─ callback/
            │  └─ route.ts       # トークン交換 → Cookie 保存
            ├─ status/
            │  └─ route.ts       # ログイン状態確認
            └─ logout/
               └─ route.ts       # Cookie 削除
```

---

## これからの開発手順

### ステップ 1: 認証フローの完成
- [ ] `/login` ページでボタンを押すと Spotify 認可画面へ遷移
- [ ] 認可後に `/` へリダイレクト、Cookie にトークン保存
- [ ] `/api/auth/status` が `{ loggedIn: true }` を返す

### ステップ 2: Spotify API の呼び出し基盤
- [ ] `src/lib/spotify.ts` を追加し、`fetch` のラッパを作る  
  - `getMe`（ユーザー情報取得）  
  - `createPlaylist`（プレイリスト作成）  
  - `addTracks`（曲追加）  

### ステップ 3: UI の拡張
- [ ] `/me` ページを作り、ログインユーザー名を表示
- [ ] `/playlist/create` ページでプレイリスト作成テスト

### ステップ 4: TRIW アプリ本体機能
- [ ] 曲リスト生成（ChatGPT API）
- [ ] Spotify から実際のトラック情報取得
- [ ] プレイリスト作成＆保存
- [ ] ナレーション生成（TTS API）

---

## ファイル構成予定（追加イメージ）

```
triw-app/
├─ src/
│  ├─ lib/
│  │  └─ spotify.ts             # Spotify API ラッパ
│  ├─ app/
│  │  ├─ me/
│  │  │  └─ page.tsx            # ユーザー情報表示
│  │  ├─ playlist/
│  │  │  ├─ create/
│  │  │  │  └─ page.tsx         # プレイリスト作成 UI
│  │  │  └─ [id]/
│  │  │     └─ page.tsx         # 作成したプレイリスト詳細
│  │  └─ api/
│  │     ├─ playlist/
│  │     │  └─ create/
│  │     │     └─ route.ts      # プレイリスト作成 API
│  │     └─ narrate/
│  │        └─ route.ts         # ナレーション生成 API
└─ docs/
   ├─ devlog_2025-08-31.md       # 本ファイル
   └─ roadmap.md                 # 中長期的な開発ロードマップ
```

---

## 今日のまとめ
- Home ✅ が表示される最小構成が完成
- GitHub に push 済み（安心して戻せる状態）
- 次のタスクは **Spotify 認証フロー完成** → **Spotify API 呼び出し基盤**
